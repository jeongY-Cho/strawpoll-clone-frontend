(this["webpackJsonpstrawpoll-clone-frontend"]=this["webpackJsonpstrawpoll-clone-frontend"]||[]).push([[0],{33:function(e,t,a){e.exports=a(63)},38:function(e,t,a){},39:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(26),c=a.n(o),r=(a(38),a(39),a(6)),i=a(1),s=a(10),u=a(27),m=a(28),p=a(31),d=a(32),h=a(7),E=a.n(h),v=a(4),g=function(e){return l.a.createElement("div",null,l.a.createElement("h3",null,e.prompt),l.a.createElement("div",{style:{paddingBottom:5}},"Created: ",new Date(e.createdAt).toLocaleString()))},f=function(e){var t=Object(n.useState)(""),a=Object(v.a)(t,2),o=a[0],c=a[1];console.log(e);var r=Object(i.f)(),s=Object(i.g)().url;return l.a.createElement("div",{style:{textAlign:"left",margin:50,paddingLeft:"20%"}},l.a.createElement(g,{createdAt:e.createdAt,prompt:e.prompt}),e.choices.map((function(e,t){var a="choice:"+t;return l.a.createElement("div",{className:"custom-control custom-radio",key:t},l.a.createElement("input",{type:"radio",id:a,name:"choices",value:a,className:"custom-control-input",checked:o===a,onChange:function(){c(a)}}),l.a.createElement("label",{htmlFor:a,className:"custom-control-label"},e.text))})),l.a.createElement("br",null),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:function(t){E.a.post("https://strawpoll.jeongyeoncho.com/api/".concat(e.id),{inc:o.split(":")[1]}).then((function(){r.push("".concat(s,"/r"))}))}},"Vote"),l.a.createElement("button",{className:"btn btn-outline-secondary btn-sm",onClick:function(){return r.push("".concat(s,"/r"))}},"Results")))},b=function(e){var t=Object(n.useState)(!1),a=Object(v.a)(t,2),o=a[0],c=a[1];return l.a.createElement("div",null,"Click to copy link to this poll:",l.a.createElement("div",null,l.a.createElement("input",{type:"text",value:window.location.href.replace("/r",""),onClick:function(e){e.target.select(),document.execCommand("copy"),c(!0)},readOnly:!0})),o&&l.a.createElement("div",{className:"text-info"},"Link copied!"))},y=a(30),w=a.n(y).a.scale(["#264653","#2A9D8F","#E9C46A","#F4A261","#E76F51"]),k=function(e){var t=w.colors(e.choices.length),a=e.choices.reduce((function(e,t){return e>t.count?e:t.count}),0);return l.a.createElement("div",null,l.a.createElement(g,{prompt:e.prompt,createdAt:e.createdAt}),l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center"}},l.a.createElement("div",{style:{marginRight:20,maxWidth:"80%",minWidth:200}},l.a.createElement("table",{style:{width:"100%"}},l.a.createElement("colgroup",null,l.a.createElement("col",{style:{width:"2rem",backgroundColor:"rgba(0,0,0,0.1)"}}),l.a.createElement("col",{style:{width:"3rem",backgroundColor:"rgba(0,0,0,0.1)"}})),l.a.createElement("tbody",null,e.choices.map((function(n,o){var c="".concat(Math.round(n.count/e.total*100),"%");return l.a.createElement(l.a.Fragment,{key:o},l.a.createElement("tr",null,l.a.createElement("td",null,c),l.a.createElement("td",null,n.count),l.a.createElement("td",{style:{textAlign:"left",overflowWrap:"anywhere",paddingLeft:10}},n.text)),l.a.createElement("tr",null,l.a.createElement("td",{colSpan:3},l.a.createElement("div",{style:{backgroundColor:a===n.count?t[o%t.length]:"rgba(0,0,0,0.1)",width:n.count?c:"1%",height:10}}))))})))),l.a.createElement("div",null,e.total," Votes"),l.a.createElement("br",null),l.a.createElement(b,null)),l.a.createElement("div",{style:{minWidth:200,padding:20}},l.a.createElement(j,{choices:e.choices,total:e.total,colors:t}))))},j=function(e){var t=Object(n.useState)(void 0),a=Object(v.a)(t,2),o=a[0],c=a[1];return l.a.createElement(O,{animate:!0,label:function(e){return"0%"===e.dataEntry.label?"":e.dataEntry.label},labelStyle:{fill:"beige",opacity:.95,fontSize:10},data:e.choices.map((function(t,a){var n="".concat(Math.round(100*t.count/e.total),"%");return{label:a===o?t.count:n,title:t.text,value:t.count,color:e.colors[a%e.colors.length],percentage:n}})),startAngle:180,onMouseOver:function(e,t){c(t)},onMouseOut:function(){c(void 0)}})},x=function(e){var t=e.showButton,a=l.a.useState(""),n=Object(v.a)(a,2),o=n[0],c=n[1],r=(Object(i.f)(),function(){window.location.href="/".concat(o.toLowerCase())});return l.a.createElement("div",null,l.a.createElement("input",{type:"text",placeholder:"Go to a Poll",style:{background:"rgba(0,0,0,0)"},value:o,onKeyDown:function(e){"Enter"===e.key&&(console.log("enter"),r())},onChange:function(e){c(e.target.value)}}),t&&l.a.createElement("button",{className:"btn btn-primary",onClick:r},"Go"))},O=a(62).PieChart,C=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={invalid:!1,loaded:!1,poll:{total:0,createdAt:"",id:"",choices:[{text:"item 1",count:100},{text:"item 2",count:0}],prompt:"this is a question"}},n.socket=void 0,n.socket=new WebSocket("wss://strawpoll.jeongyeoncho.com/api/live/".concat(n.props.match.params.id)),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.socket.onmessage=function(t){var a=JSON.parse(t.data);if("invalid id"!==t.data){var n=Object(s.a)(e.state.poll.choices);Object.keys(a).forEach((function(e){if("total"!==e){var t=parseInt(e.split(":")[1]);n[t].count=a[e]}})),e.setState({poll:{prompt:e.state.poll.prompt,createdAt:e.state.poll.createdAt,id:e.state.poll.id,total:a.total,choices:n}});var l=!1;e.socket.onclose=function(){l?console.log("closed"):(l=!0,e.socket=new WebSocket("wss://strawpoll.jeongyeoncho.com/api/live/".concat(e.props.match.params.id)))}}else e.setState({invalid:!0})},E.a.get("https://strawpoll.jeongyeoncho.com/api/"+this.props.match.params.id).then((function(t){t.data.id?(console.log(t.data),e.setState({poll:t.data,loaded:!0}),console.log(t.data)):e.setState({invalid:!0})}))}},{key:"componentWillUnmount",value:function(){this.socket.close()}},{key:"render",value:function(){return this.state.invalid?l.a.createElement("div",null,l.a.createElement("div",null,"Invalid id"),l.a.createElement(x,{showButton:!0}),l.a.createElement("div",null)):l.a.createElement("div",null,l.a.createElement(i.a,{path:"".concat(this.props.match.url,"/r")},l.a.createElement(k,this.state.poll)),l.a.createElement(i.a,{path:this.props.match.url,exact:!0},l.a.createElement(f,this.state.poll),l.a.createElement(b,null)))}}]),a}(l.a.Component),S=function(e){var t=Object(i.f)(),a=l.a.useState(""),n=Object(v.a)(a,2),o=n[0],c=n[1],r=l.a.useState(["",""]),u=Object(v.a)(r,2),m=u[0],p=u[1],d=l.a.useState(""),h=Object(v.a)(d,2),g=h[0],f=h[1],b=function(){var e=m.filter((function(e){return e}));if(o&&e.length){var a={prompt:o,choices:e,id:g.length?g.trim().replace(/ /g,"-").replace(/-$/,""):void 0};console.log(a),E.a.put("https://strawpoll.jeongyeoncho.com/api/new",a).then((function(e){t.push("/".concat(e.data.id))}))}},y=m.map((function(e,t){return l.a.createElement("div",{key:t},l.a.createElement("input",{type:"text",placeholder:"Enter poll option","data-i":t,value:m[t],onKeyDown:function(e){"Enter"===e.key?b():"Tab"===e.key&&e.target.value&&parseInt(e.target.dataset.i)===m.length-1&&p(m.concat([""]))},onChange:function(e){e.preventDefault(),e.persist(),m[t]=e.target.value;var a=Object(s.a)(m);a[t]=e.target.value,p(a)},onBlur:function(e){var t=parseInt(e.target.dataset.i);if(!e.target.value&&m.length>2&&t!==m.length-1){var a=Object(s.a)(m);a.splice(parseInt(e.target.dataset.i),1),p(a)}}}))}));return l.a.createElement("div",null,l.a.createElement("input",{type:"text",value:o,onChange:function(e){c(e.target.value)},placeholder:"Type your question here",style:{fontSize:25}}),y,l.a.createElement("div",{style:{padding:10}},l.a.createElement("button",{className:"btn btn-outline-success btn-small",onClick:function(){m[m.length-1]&&p(m.concat([""]))}},"+")),l.a.createElement("button",{className:"btn btn-outline-primary btn-large",onClick:b},"Make New Poll"),l.a.createElement("div",null,l.a.createElement("input",{maxLength:128,type:"text",placeholder:"custom poll ID (optional)",value:g,onChange:function(e){f(e.target.value.replace(/ /g,"-").replace(/-+/g,"-").replace(/[^a-zA-Z0-9-_]/gi,"").toLowerCase())}})))},N=function(){return l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"jumbotron"},l.a.createElement("h2",null,"Strawpoll"),l.a.createElement("p",null,"This is an"," ",l.a.createElement("a",{href:"https://github.com/jeongY-Cho/strawpoll-clone"},"open source")," ","strawpoll clone. Built on ",l.a.createElement("a",{href:"https://expressjs.com/"},"express"),", ",l.a.createElement("a",{href:"https://redis.io/"},"redis")," and"," ",l.a.createElement("a",{href:"https://prisma.io"},"prisma"),"."),l.a.createElement("div",{className:"btn-group flex-wrap"},l.a.createElement("a",{className:"btn btn-primary",href:"/",style:{lineHeight:2.3}},"Make Poll"),l.a.createElement("div",{className:"btn btn-outline-light"},l.a.createElement(x,null)),l.a.createElement("button",{className:"btn btn-outline-secondary"},l.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},l.a.createElement("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"}))))),l.a.createElement(i.c,null,l.a.createElement(i.a,{path:"/",exact:!0},l.a.createElement("h3",null,"Make a Poll"),l.a.createElement(S,null)),l.a.createElement(i.a,{path:"/:id",component:C})))},A=function(e){return l.a.createElement(r.a,null,l.a.createElement(N,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.ebe735b4.chunk.js.map